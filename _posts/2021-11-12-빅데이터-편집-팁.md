---
title:  "[Code] ì‚¬ì´ì¦ˆê°€ í° ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” íŒ ëª¨ìŒ"
excerpt: "ë²•ë ¹ì •ë³´ì„¼í„° API ê°€ì ¸ì˜¤ëŠ” ì½”ë“œì— ê´€í•œ ê¸€ì…ë‹ˆë‹¤."

toc: true
toc_sticky: true
toc_label: "ì£¼ìš” ëª©ì°¨"
 
date: 2021-11-09
last_modified_at: 2021-11-09

use_math: true
comments: true

categories:
  - ETC
---





- ë°ì´í„° ì‚¬ì´ì¦ˆ : 30ë§Œ ê±´ ì´ìƒì˜ ë”•ì…”ë„ˆë¦¬ë¡œ êµ¬ì„±ëœ ë¦¬ìŠ¤íŠ¸



## ğŸ“Œ ë°ì´í„° í¬ë§· : ë¦¬ìŠ¤íŠ¸ ì•ˆì˜ ë”•ì…”ë„ˆë¦¬ ìì²´ë¥¼ ì´ìš©

- (ìƒí™©) APIë¡œë¶€í„° ìµœì†Œ 20ë§Œ ê±´ì˜ ë°ì´í„°ë¥¼ ë°›ì•„ì•¼ í•¨
- ì²˜ìŒì—ëŠ” ê° html íƒœê·¸ë¥¼ íŒŒì‹±í•˜ì—¬ ë”•ì…”ë„ˆë¦¬ë¡œ ë°›ê³ , ì´ê²ƒì„ ë‹¤ì‹œ pandasì˜ DataFrame í¬ë§·ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥í•¨
- API ì ‘ì†ì´ ëŠì–´ì§ˆ ë•Œë§ˆë‹¤ ì†ì‹¤ë˜ëŠ” ë°ì´í„° ìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ë°ì´í„° ì €ì¥ì— ë“¤ì´ëŠ” ì‹œê°„ì„ ì¤„ì´ê¸°ë¡œ í•¨
- ì•„ì˜ˆ ë¦¬ìŠ¤íŠ¸ ì•ˆì— ì—¬ëŸ¬ ê°œì˜ ë”•ì…”ë„ˆë¦¬ë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜´

```python
all_data = [{key1: value1, key2: value2, ...},
           {key1: value1, key2: value2, ...},
           {key1: value1, key2: value2, ...}, ...]
```





## ğŸ“Œ ë°ì´í„° ì…‹ : pickleë¡œ ì €ì¥

- ìœ„ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ pickle íŒŒì¼ í¬ë§·ìœ¼ë¡œ ì €ì¥í•¨
- [pickle ì°¸ê³ ë¬¸ì„œ](https://docs.python.org/3/library/pickle.html)
- pickle í˜•ì‹ì€ íŒŒì´ì¬ì—ì„œ ê°ì²´ë¥¼ ì €ì¥í•˜ëŠ” íŒŒì¼ í˜•ì‹ì„
- ë¡œë”©ì´ ë§¤ìš° ë¹¨ë¼ì„œ í° ê·œëª¨ì˜ ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ í¸ë¦¬í•¨

```python
import pickle
 
# pickle ì €ì¥
with open("all_data.pickle","wb") as f:
    pickle.dump(all_data, f)
 
# pickle ë¶ˆëŸ¬ì˜¤ê¸°
with open("./all_data.pickle","rb") as f:
    all_data = pickle.load(f)
```



## ğŸ“Œ ì¤‘ë³µ  ì œê±° : ë¹ ë¥´ê²Œ í•˜ê¸° ìœ„í•´ ë¬¸ìì—´ë¡œ ë³€í™˜

- (ë¬¸ì œ) ë¦¬ìŠ¤íŠ¸ ì•ˆì˜ ìš”ì†Œê°€ ë”•ì…”ë„ˆë¦¬ì¸ ê²½ìš° setì„ ì´ìš©í•œ ì¤‘ë³µ ì œê±°ê°€ ë¶ˆê°€ëŠ¥í•¨
- (ë¬¸ì œ) remove, pop ë“±ì˜ ë©”ì„œë“œë¥¼ ì´ìš©í•œ ìš”ì†Œ ì¤‘ë³µ ì œê±°ëŠ” ì‹œê°„ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦¼
- (í•´ê²°) ê° ë”•ì…”ë„ˆë¦¬ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ ì¤‘ë³µ ì œê±°í•¨
- ë‹¤ë¥¸ ë°©ë²•ë³´ë‹¤ í›¨ì”¬ ë¹ ë¥´ê²Œ ì‘ë™í•¨

```python
def remove_duplicates(all_data):
	# ì¤‘ë³µëœ ê°’ ì—†ì´ ê° ìš”ì†Œë¥¼ ì €ì¥í•  set() ìƒì„±
    row = set()
    # ë°ì´í„° ì „ì²´ì— ëŒ€í•˜ì—¬ ìˆœíšŒí•¨
    for data in all_data:
        # ë¬¸ìì—´ë¡œ ë³€í™˜í•œ ë°ì´í„°ë¥¼ set()ì— ì¶”ê°€í•¨
        row.add(str(data))
    return row
```

```python
# rowì— ë‹´ê¸´ ê°’ í™•ì¸
row = remove_duplicates(all_data)
>>>
{"{key1: value1, key2: value2, ...}",
"{key1: value1, key2: value2, ...}",
"{key1: value1, key2: value2, ...}", ...}
```

- (ë³µêµ¬) ë¬¸ìì—´ë¡œ ë³€í™˜ëœ ìš”ì†Œë¥¼ ë‹¤ì‹œ ë”•ì…”ë„ˆë¦¬ë¡œ ë³€í™˜í•˜ê³  ì‹¶ì€ ê²½ìš°, eval ë©”ì„œë“œ ì´ìš©í•¨

```python
def restore_dataset(row):
	restore_data = []
    # row ì•ˆì˜ ë¬¸ìì—´ì— ëŒ€í•´ ìˆœíšŒí•¨
    for data in row:
        # ê° ë¬¸ìì—´ì— ëŒ€í•´ evalì„ ì ìš©í•˜ë©´ ë”°ì˜´í‘œë¥¼ ì œê±°í•œ ì½”ë“œ ê·¸ëŒ€ë¡œ ê¸°ëŠ¥í•¨
        restore_data.append(eval(data))
	return restore_data
```



## ğŸ“Œ ë°ì´í„° íƒìƒ‰ ë° í¸ì§‘ : pandasì˜ DataFrame ì´ìš©

### ë°ì´í„° í”„ë ˆì„ ìƒì„±

```python
# ë°ì´í„°í”„ë ˆì„ ìƒì„±
df = pd.DataFrame(restore_data)
```

### mask í™œìš©

- pandas ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ìµìˆ™í•´ì§€ë©´ í•„í„°ë§ì„ ì´ìš©í•œ íƒìƒ‰ì´ í¸í•´ì§
- ```DataFrame.loc[]```ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ maskë¥¼ ì´ìš©í•œ íƒìƒ‰ì´ ë” ë¹ ë¥´ê²Œ ì²˜ë¦¬ë˜ëŠ” í¸ì„
- maskëŠ” ì—¬ëŸ¬ ê°œ ì¤‘ë³µí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
- ğŸ¥ pandas ì†ŒìŠ¤ì½”ë“œ ì°¾ì•„ë³´ì. loc í•¨ìˆ˜ì— forë¬¸ì´ í¬í•¨ë˜ëŠ” ê²ƒ ê°™ìŒ

```python
# mask ìƒì„±
mask = df['ì»¬ëŸ¼1'] == 'íŠ¹ì •ê°’'
# mask ì ìš©
df[mask]
```

### ë°ì´í„°í”„ë ˆì„ì—ì„œ ì •ê·œì‹ í™•ì¸í•˜ê¸°

```python
# pandas ê° í–‰ì—ì„œ íŠ¹ì • ë¬¸ìì—´ íŒ¨í„´ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•
for string in strings:
    # ì‹œë¦¬ì¦ˆì˜ ê° ìš”ì†Œë¥¼ ë¬¸ìì—´ë¡œ ë°›ëŠ” ë¦¬ìŠ¤íŠ¸ì— ëŒ€í•´
    all_titles = df['ì»¬ëŸ¼1'].str
    # íŠ¹ì • ë¬¸ìì—´ íŒ¨í„´ì´
    pattern = r"^"+string+r".?ë“±$"
    # í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ maskë¡œ ìƒì„±í•¨
    mask = all_titles.contains(pattern, regex=True).astype('boolean')
    # í•´ë‹¹ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²½ìš°ì˜ ë°ì´í„°ë¥¼ ì¤‘ë³µì œê±°í•˜ê³  ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥
    string_extend = df[mask]['ë°ì´í„°ë¥¼ ì¶”ì¶œí•  ì»¬ëŸ¼'].unique().tolist()
```

- ```pd.DataFrame.contains(pattern)```

- DataFrame ì•ˆì— patternì´ ì¡´ì¬í•˜ëŠ”ì§€ ë°˜í™˜í•¨

- regex=Trueë¡œ í•´ì•¼ ì •ê·œí‘œí˜„ì‹ì„ ì¸ì‹

- ì¼ë¶€ ê²°ì¸¡ì¹˜ëŠ” NaNìœ¼ë¡œ dtypeì´ floatì´ê¸° ë•Œë¬¸ì—, ì»¬ëŸ¼ì„ maskë¡œ ì´ìš©í•˜ë ¤ë©´ ```astype()```ì„ ì´ìš©í•˜ì—¬ ```'boolean'``` íƒ€ì…ìœ¼ë¡œ  ë³€í™˜í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•¨

  
